# =============================================================================
# Drone CI Environment Configuration - INDEPENDENT
# =============================================================================
# Copy this file to .env.drone and fill in your values:
#   cp .env.drone.example .env.drone
#
# ⚠️  IMPORTANT: This configuration is COMPLETELY INDEPENDENT
#
# - This file (.env.drone) is SEPARATE from .env (if it exists)
# - NO variables are shared with NoteHub or any other application
# - Drone CI has its own GitHub OAuth App (separate credentials)
# - Can be used with or without NoteHub present
# - Can be deployed on a completely different server
#
# Setup Instructions:
# 1. Create a NEW GitHub OAuth App at https://github.com/settings/developers
#    (This is SEPARATE from any other OAuth apps you have)
# 2. Set Authorization callback URL to: http://your-domain:8080/login
# 3. Copy the NEW Client ID and Client Secret to this file
# 4. Generate RPC secret with: openssl rand -hex 16
# 5. Configure your server hostname (can be different from any other apps)
# =============================================================================

# =============================================================================
# Required Configuration
# =============================================================================

# GitHub OAuth Application (INDEPENDENT - Create a NEW OAuth App for Drone CI)
# Create NEW app at: https://github.com/settings/developers
# Authorization callback URL: http://your-domain:8080/login
# ⚠️  These credentials are ONLY for Drone CI - not shared with other apps
DRONE_GITHUB_CLIENT_ID=your-github-oauth-client-id
DRONE_GITHUB_CLIENT_SECRET=your-github-oauth-client-secret

# Server Configuration
# Your server's public hostname or IP (without http://)
# Examples:
#   - localhost:8080 (for local testing)
#   - drone.example.com (for production with reverse proxy)
#   - 123.45.67.89:8080 (direct IP access)
DRONE_SERVER_HOST=localhost:8080

# Protocol (http or https)
# Use 'https' in production with a reverse proxy (nginx, Caddy, Traefik)
DRONE_SERVER_PROTO=http

# RPC Secret for server-runner communication
# Generate with: openssl rand -hex 16
# IMPORTANT: Keep this secret secure!
DRONE_RPC_SECRET=generate-with-openssl-rand-hex-16

# =============================================================================
# Database Configuration
# =============================================================================
# PostgreSQL credentials for Drone's database

DRONE_POSTGRES_USER=drone
DRONE_POSTGRES_PASSWORD=change-this-secure-password
DRONE_POSTGRES_DB=drone

# =============================================================================
# Optional: User Management
# =============================================================================

# Auto-create admin user (format: username:admin-token,admin:true)
# Leave empty to manually approve users via UI
# Example: DRONE_USER_CREATE=username:your-github-username,admin:true
DRONE_USER_CREATE=

# Close registration (require admin approval for new users)
# Set to 'true' for private Drone instance
DRONE_REGISTRATION_CLOSED=false

# =============================================================================
# Optional: Runner Configuration
# =============================================================================

# Maximum number of concurrent pipelines
DRONE_RUNNER_CAPACITY=2

# Runner name (for identification when using multiple runners)
DRONE_RUNNER_NAME=docker-runner

# =============================================================================
# Optional: Logging and Debugging
# =============================================================================

# Enable debug logs (useful for troubleshooting)
DRONE_LOGS_DEBUG=false
DRONE_LOGS_TRACE=false
DRONE_DEBUG=false
DRONE_TRACE=false

# =============================================================================
# Port Configuration (Reference Only - Not Environment Variables)
# =============================================================================
# These are the actual ports used:
#   - Drone Server UI: 8080 (mapped to container port 80)
#   - Drone Runner:    Internal only, no exposed ports
#   - PostgreSQL:      Internal only (port 5432)
#   
# NoteHub uses port 80, so Drone uses 8080 to avoid conflicts.
# Both can run on the same VPS server without issues.
# =============================================================================

# =============================================================================
# Production Recommendations
# =============================================================================
# For production deployments:
# 
# 1. Use HTTPS with a reverse proxy:
#    - nginx, Caddy, or Traefik
#    - Set DRONE_SERVER_PROTO=https
#    - Update DRONE_SERVER_HOST to your domain
# 
# 2. Secure your secrets:
#    - Use strong passwords for PostgreSQL
#    - Generate a strong RPC secret
#    - Never commit .env.drone to version control
# 
# 3. Restrict access:
#    - Set DRONE_REGISTRATION_CLOSED=true
#    - Use DRONE_USER_CREATE to create admin user
#    - Approve users manually via UI
# 
# 4. Monitor resources:
#    - Adjust DRONE_RUNNER_CAPACITY based on server resources
#    - Monitor disk space for build artifacts
#    - Set up log rotation
# =============================================================================
