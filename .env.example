# =============================================================================
# NoteHub Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# Environment Modes:
#   - Development (default): docker compose up -d
#     Uses SQLite, allows database seeding
#
#   - Production: docker compose --profile production up -d
#     Uses cloud DB (DATABASE_URL), blocks seeding
#
#   - MySQL (development): docker compose --profile mysql up -d
#     Uses local MySQL container, allows seeding
# =============================================================================

# =============================================================================
# Required Configuration (all modes)
# =============================================================================

# JWT Secret (generate with: openssl rand -hex 32)
SECRET_KEY=your-super-secret-key-change-this

# Admin credentials (REQUIRED - CHANGE THESE!)
# Password must be at least 12 characters with uppercase, lowercase, and numbers
NOTES_ADMIN_USERNAME=admin
NOTES_ADMIN_PASSWORD=YourSecurePassword123!

# =============================================================================
# Production Configuration (--profile production)
# =============================================================================
# For production deployments connecting to cloud databases (PlanetScale, AWS RDS, etc.)
#
# DATABASE_URL format:
#   MySQL:      mysql://user:password@host:3306/database
#   PostgreSQL: postgresql://user:password@host:5432/database
#
# OR use separate MySQL variables:
# DATABASE_URL=mysql://notehub:password@db.example.com:3306/notehub

# Optional: API URL for frontend (if backend is on different domain)
# VITE_API_URL=https://api.example.com

# =============================================================================
# MySQL Development Configuration (--profile mysql)
# =============================================================================
# These variables are ONLY used when running:
#   docker compose --profile mysql up -d
#
# For SQLite (default), leave these as-is or remove them.
# The application will use SQLite at /app/data/notes.db
# =============================================================================
MYSQL_ROOT_PASSWORD=change-this-root-password
MYSQL_USER=notehub
MYSQL_PASSWORD=change-this-password
MYSQL_DATABASE=notehub

# =============================================================================
# Database Replication Configuration (Optional)
# =============================================================================
# Enable read replicas for improved performance and high availability
# Supports both MySQL and SQLite replication
#
# Benefits:
#   - Distribute read load across multiple database instances
#   - Improved performance for read-heavy workloads
#   - High availability with automatic failover
#   - Reduced latency with geographically distributed replicas
# =============================================================================

# Enable/disable replication (default: false)
# DB_REPLICATION_ENABLED=true

# -----------------------------------------------------------------------------
# MySQL Replication Configuration
# -----------------------------------------------------------------------------
# Configure one or more MySQL read replicas
# Replicas must be configured for replication from the primary MySQL server
#
# MYSQL_REPLICA_HOSTS: Comma-separated list of replica hostnames
# MYSQL_REPLICA_PORTS: Comma-separated list of replica ports (optional, default: 3306)
# MYSQL_REPLICA_USER: Username for replica connections (default: same as MYSQL_USER)
# MYSQL_REPLICA_PASSWORD: Password for replicas (default: same as MYSQL_PASSWORD)
#
# Examples:
#   Single replica:     MYSQL_REPLICA_HOSTS=mysql-replica-1
#   Multiple replicas:  MYSQL_REPLICA_HOSTS=mysql-replica-1,mysql-replica-2,mysql-replica-3
#   Custom ports:       MYSQL_REPLICA_PORTS=3306,3307,3308
# -----------------------------------------------------------------------------
# MYSQL_REPLICA_HOSTS=mysql-replica-1,mysql-replica-2
# MYSQL_REPLICA_PORTS=3306,3306
# MYSQL_REPLICA_USER=notehub
# MYSQL_REPLICA_PASSWORD=change-this-password
# MYSQL_REPLICATION_PASSWORD=change-this-replication-password

# -----------------------------------------------------------------------------
# SQLite Replication Configuration
# -----------------------------------------------------------------------------
# Configure one or more SQLite replica database files
# Replicas should be synchronized copies of the primary database
# Can be created using tools like Litestream, rsync, or SQLite backup API
#
# SQLITE_REPLICA_PATHS: Comma-separated list of replica database file paths
#
# Examples:
#   Single replica:     SQLITE_REPLICA_PATHS=/app/data/notes-replica1.db
#   Multiple replicas:  SQLITE_REPLICA_PATHS=/app/data/notes-replica1.db,/app/data/notes-replica2.db
#
# Note: SQLite replicas are opened in read-only mode
# Use Litestream or similar tools to keep replicas synchronized with the primary
# -----------------------------------------------------------------------------
# SQLITE_REPLICA_PATHS=/app/data/notes-replica1.db,/app/data/notes-replica2.db

# =============================================================================
# Optional: Redis Caching (Performance Enhancement)
# =============================================================================
# Redis improves performance by caching frequently accessed data
# If not configured, the application works without caching (slower performance)
#
# Examples:
#   Local Redis:        REDIS_HOST=localhost
#   Redis URL:          REDIS_URL=redis://localhost:6379
#   Redis with auth:    REDIS_URL=redis://:password@localhost:6379
#   Redis Cloud:        REDIS_URL=redis://user:password@redis-cloud-host:port
# =============================================================================
# REDIS_URL=redis://localhost:6379
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# =============================================================================
# Optional: Elasticsearch (Full-Text Search Enhancement)
# =============================================================================
# Elasticsearch provides powerful full-text search capabilities
# If not configured, the application uses SQL LIKE (basic search)
#
# Examples:
#   Local ES:           ELASTICSEARCH_NODE=http://localhost:9200
#   ES with basic auth: ELASTICSEARCH_USERNAME=elastic
#                       ELASTICSEARCH_PASSWORD=changeme
#   ES Cloud:           ELASTICSEARCH_NODE=https://your-cloud-id.es.io:9243
#                       ELASTICSEARCH_API_KEY=your-api-key
# =============================================================================
# ELASTICSEARCH_NODE=http://localhost:9200
# ELASTICSEARCH_USERNAME=elastic
# ELASTICSEARCH_PASSWORD=changeme
# ELASTICSEARCH_API_KEY=

# =============================================================================
# Optional: Google OAuth (Single Sign-On)
# =============================================================================
# Enable users to sign in with their Google account
# If not configured, traditional username/password login is used
#
# Setup Instructions:
# 1. Go to Google Cloud Console: https://console.cloud.google.com/
# 2. Create a new project or select existing
# 3. Enable Google+ API
# 4. Create OAuth 2.0 credentials
# 5. Add authorized redirect URIs (ADD ALL THAT APPLY):
#    - Docker deployment:  http://localhost/auth/google/callback
#    - Local development:  http://localhost:3000/auth/google/callback
#    - Production:         https://your-domain.com/auth/google/callback
#
# IMPORTANT: The redirect URI must match EXACTLY with what you configure below
# and what you added in Google Cloud Console.
#
# Examples:
#   Docker (port 80):     GOOGLE_REDIRECT_URI=http://localhost/auth/google/callback
#   Development (3000):   GOOGLE_REDIRECT_URI=http://localhost:3000/auth/google/callback
#   Production:           GOOGLE_REDIRECT_URI=https://yourdomain.com/auth/google/callback
# =============================================================================
# GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
# GOOGLE_CLIENT_SECRET=your-client-secret
# GOOGLE_REDIRECT_URI=http://localhost/auth/google/callback

# =============================================================================
# Optional: Passkey Authentication (WebAuthn/FIDO2)
# =============================================================================
# Enable passwordless authentication using biometrics and security keys
# If not configured, the system will auto-detect and enable in development
#
# IMPORTANT: WebAuthn requires HTTPS in production (except localhost)
# The RP_ID should match your domain without protocol or port
#
# Setup Instructions:
# 1. Configure WEBAUTHN_RP_ID to match your domain
# 2. Set WEBAUTHN_RP_NAME to your application name
# 3. Set WEBAUTHN_ORIGIN to match your frontend URL (must include protocol)
#
# Examples:
#   Development:  WEBAUTHN_RP_ID=localhost
#                 WEBAUTHN_RP_NAME=NoteHub
#                 WEBAUTHN_ORIGIN=http://localhost:3000
#
#   Production:   WEBAUTHN_RP_ID=notehub.example.com
#                 WEBAUTHN_RP_NAME=NoteHub
#                 WEBAUTHN_ORIGIN=https://notehub.example.com
#
# Note: In development, these values are auto-detected if not set
# =============================================================================
# WEBAUTHN_RP_ID=localhost
# WEBAUTHN_RP_NAME=NoteHub
# WEBAUTHN_ORIGIN=http://localhost:3000

# =============================================================================
# Optional: AI Writing Tools (Text Improvement)
# =============================================================================
# Enable AI-powered text improvement features (proofread, summarize, rewrite)
# Choose one provider: openai, gemini, or ollama
#
# Setup Instructions:
# 1. Choose your AI provider (openai, gemini, or ollama)
# 2. Configure the required credentials/settings below
# 3. Set AI_PROVIDER to your chosen provider
#
# Providers:
# - openai: Requires API key from https://platform.openai.com/api-keys
# - gemini: Requires API key from https://makersuite.google.com/app/apikey
# - ollama: Local AI, requires Ollama running at OLLAMA_URL
#
# Examples:
#   OpenAI:         AI_PROVIDER=openai
#                   OPENAI_API_KEY=sk-...
#                   OPENAI_MODEL=gpt-4o-mini
#
#   Gemini:         AI_PROVIDER=gemini
#                   GEMINI_API_KEY=AIza...
#                   GEMINI_MODEL=gemini-1.5-flash
#
#   Ollama (Local): AI_PROVIDER=ollama
#                   OLLAMA_URL=http://localhost:11434
#                   OLLAMA_MODEL=llama3.2
# =============================================================================
# AI_PROVIDER=ollama
# OPENAI_API_KEY=sk-your-openai-api-key
# OPENAI_MODEL=gpt-4o-mini
# GEMINI_API_KEY=your-gemini-api-key
# GEMINI_MODEL=gemini-1.5-flash
# OLLAMA_URL=http://localhost:11434
# OLLAMA_MODEL=llama3.2

# =============================================================================
# Logging Configuration
# =============================================================================
# Configure logging behavior for both frontend and backend
#
# LOG_LEVEL: Set the minimum log level to display
#   - error: Only show errors (production default)
#   - warn: Show warnings and errors
#   - info: Show info, warnings, and errors (development default)
#   - debug: Show all logs including debug messages
#   - silent: Disable all logging
#
# LOG_FORMAT: Choose log output format (backend only)
#   - json: Structured JSON logs (machine-readable, production default)
#   - simple: Human-readable simple format (development default)
#   - detailed: Detailed format with timestamps and context
#
# Examples:
#   Development:  LOG_LEVEL=info, LOG_FORMAT=simple
#   Production:   LOG_LEVEL=error, LOG_FORMAT=json
#   Debugging:    LOG_LEVEL=debug, LOG_FORMAT=detailed
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=simple

# =============================================================================
# Graylog Integration (Optional)
# =============================================================================
# Send logs to Graylog for centralized log management and analysis
# Requires Graylog server running (see docker-compose.graylog.yml)
#
# Setup Instructions:
# 1. Deploy Graylog using docker-compose.graylog.yml
# 2. Configure GELF input in Graylog UI (System â†’ Inputs)
# 3. Enable Graylog integration by setting GRAYLOG_ENABLED=true
# 4. Configure connection settings below
#
# Configuration:
#   GRAYLOG_ENABLED: Enable/disable Graylog integration (true/false)
#   GRAYLOG_HOST: Graylog server hostname or IP
#   GRAYLOG_PORT: GELF input port (default: 12201)
#   GRAYLOG_PROTOCOL: Protocol to use (udp or tcp)
#   GRAYLOG_FACILITY: Log facility name for categorization
#
# Examples:
#   Local Graylog:   GRAYLOG_ENABLED=true
#                    GRAYLOG_HOST=localhost
#                    GRAYLOG_PORT=12201
#                    GRAYLOG_PROTOCOL=udp
#
#   Remote Graylog:  GRAYLOG_ENABLED=true
#                    GRAYLOG_HOST=logs.yourdomain.com
#                    GRAYLOG_PORT=12201
#                    GRAYLOG_PROTOCOL=tcp
#
# Note: Logs will still appear in console even when Graylog is enabled
# =============================================================================
# GRAYLOG_ENABLED=false
# GRAYLOG_HOST=localhost
# GRAYLOG_PORT=12201
# GRAYLOG_PROTOCOL=udp
# GRAYLOG_FACILITY=notehub-backend

# =============================================================================
# SSL/HTTPS Configuration (Traefik + Let's Encrypt)
# =============================================================================
# Configure automatic SSL certificate management using Let's Encrypt via Traefik
#
# IMPORTANT: SSL/HTTPS is enabled by default for all deployment profiles
#
# DOMAIN: Your domain name (REQUIRED for production with custom domains)
#   - Set this to your actual domain name (without http:// or https://)
#   - This ensures Let's Encrypt issues certificates for the correct domain
#   - Examples: yourdomain.com, note-hub.duckdns.org, app.example.com
#   - Leave blank or commented for localhost development
#   - CRITICAL: This fixes "certificate not secure" warnings when using custom domains
#
# ACME_EMAIL: Email address for Let's Encrypt certificate notifications
#   - Required for production deployments
#   - Used for certificate expiration warnings and important updates
#   - Must be a valid email address you can access
#
# Domain Requirements:
#   - Your domain must point to your server's public IP address
#   - Ports 80 and 443 must be accessible from the internet
#   - Let's Encrypt validates domain ownership before issuing certificates
#
# For Development/Testing (localhost):
#   - Leave DOMAIN blank or commented out
#   - SSL works but browsers will show security warnings
#   - Self-signed certificates are used automatically
#   - ACME_EMAIL is optional for localhost testing
#
# For Production (with domain):
#   - Set DOMAIN to your actual domain name
#   - Set ACME_EMAIL to receive certificate notifications
#   - Ensure your domain DNS points to your server
#   - Traefik automatically obtains and renews certificates
#   - Certificates are stored in ./letsencrypt/acme.json
#
# Examples:
#   Development:  
#     # DOMAIN= (leave blank)
#     # ACME_EMAIL=admin@example.com (or leave commented)
#   
#   Production with custom domain:
#     DOMAIN=yourdomain.com
#     ACME_EMAIL=admin@yourdomain.com
#   
#   Production with DuckDNS:
#     DOMAIN=note-hub.duckdns.org
#     ACME_EMAIL=admin@yourdomain.com
#
# Certificate Storage:
#   - Certificates are stored in ./letsencrypt/acme.json
#   - This file is created automatically and should not be edited
#   - Backup this file to preserve your certificates
#   - Certificates auto-renew 30 days before expiration
# =============================================================================
# DOMAIN=yourdomain.com
# ACME_EMAIL=admin@yourdomain.com

# =============================================================================
# Monitoring Configuration (Prometheus & Grafana)
# =============================================================================
# Configure Prometheus and Grafana monitoring stack
# Deploy with: docker compose -f docker-compose.monitoring.yml up -d
#
# Grafana Access:
#   - Via subdomain: https://monitoring.yourdomain.com (recommended)
#   - Via path: https://yourdomain.com/grafana
#   - Local: http://localhost:3000
#
# Default Credentials:
#   - Username: admin
#   - Password: admin (change on first login)
#
# GRAFANA_ADMIN_USER: Admin username (default: admin)
# GRAFANA_ADMIN_PASSWORD: Admin password (default: admin, CHANGE IN PRODUCTION!)
# GRAFANA_ROOT_URL: Full URL where Grafana will be accessible
# GRAFANA_DOMAIN: Domain for Grafana (for subdomain routing)
# GRAFANA_ROUTER_RULE: Custom Traefik routing rule (advanced)
#
# Examples:
#   Subdomain routing:
#     GRAFANA_DOMAIN=monitoring.yourdomain.com
#     GRAFANA_ROOT_URL=https://monitoring.yourdomain.com
#     GRAFANA_ROUTER_RULE=Host(`monitoring.yourdomain.com`)
#
#   Path-based routing:
#     GRAFANA_ROOT_URL=https://yourdomain.com/grafana
#     GRAFANA_ROUTER_RULE=PathPrefix(`/grafana`)
#
#   Local development:
#     GRAFANA_ROOT_URL=http://localhost:3000
#
# Performance Notes:
#   - Prometheus uses ~512MB RAM
#   - Grafana uses ~256MB RAM
#   - cAdvisor uses ~128MB RAM
#   - Node Exporter uses ~64MB RAM
#   - Total: ~1GB RAM overhead
#   - Suitable for 2GB RAM VPS with NoteHub and Drone CI
# =============================================================================
# GRAFANA_ADMIN_USER=admin
# GRAFANA_ADMIN_PASSWORD=change-this-secure-password
# GRAFANA_ROOT_URL=https://monitoring.yourdomain.com
# GRAFANA_DOMAIN=monitoring.yourdomain.com
# GRAFANA_ROUTER_RULE=Host(`monitoring.${DOMAIN}`)
